
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://docs.iden3.io/services/login-protocol/">
      
      
      
      
      <link rel="icon" href="../../favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.47">
    
    
      
        <title>Login Protocol - Iden3 Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#login-protocol" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Iden3 Documentation" class="md-header__button md-logo" aria-label="Iden3 Documentation" data-md-component="logo">
      
  <img src="../../logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Iden3 Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Login Protocol
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/iden3/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../basics/introduction/" class="md-tabs__link">
          
  
  The basics

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../protocol/spec/" class="md-tabs__link">
          
  
  Iden3 protocol

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../getting-started/getting-started/" class="md-tabs__link">
          
  
  Core Tutorial

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../protocol/zklogin/" class="md-tabs__link">
          
  
  Services and protocols

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../protocol/main-circuits/" class="md-tabs__link">
          
  
  Circuits

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../circom-snarkjs/" class="md-tabs__link">
        
  
    
  
  Circom / snarkjs

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../contracts/contracts/" class="md-tabs__link">
        
  
    
  
  Contracts

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../publications/publications/" class="md-tabs__link">
        
  
    
  
  Publications

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Iden3 Documentation" class="md-nav__button md-logo" aria-label="Iden3 Documentation" data-md-component="logo">
      
  <img src="../../logo.svg" alt="logo">

    </a>
    Iden3 Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/iden3/docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    The basics
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            The basics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/key-concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Key concepts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../basics/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Iden3 protocol
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Iden3 protocol
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/spec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iden3 protocol specs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Claim
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Claim
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/claims-structure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Structure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/bjjkey/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AuthBJJCredential
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/claim-schema/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Claim Schema
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Core Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Core Components
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Core Components
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/babyjubjub/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Baby Jubjub Keypair
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/mt/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sparse Merkle Tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_3" >
        
          
          <label class="md-nav__link" for="__nav_3_2_3" id="__nav_3_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Claim
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_3">
            <span class="md-nav__icon md-icon"></span>
            Claim
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/claim/generic-claim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generic Claim
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/claim/auth-claim/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Auth Claim
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_4" >
        
          
          <label class="md-nav__link" for="__nav_3_2_4" id="__nav_3_2_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Identity
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_4">
            <span class="md-nav__icon md-icon"></span>
            Identity
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/identity/identity-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/identity/identity-state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity State
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/identity/identifier/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identifier
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/identity/identity-profile/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Identity Profiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/identity/onchain-identity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OnChain Identity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Issue Claim
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Issue Claim
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/issue-claim-overview/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/signature-claim/signature/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    via Signature
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3_3" id="__nav_3_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    via Merkle Tree
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3_3">
            <span class="md-nav__icon md-icon"></span>
            via Merkle Tree
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/state-transition/state-transition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro to State Transition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/state-transition/new-identity-state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Add Claim to the Claims Tree
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/state-transition/state-transition-proof/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Generate Proof for State Transition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/state-transition/on-chain-state-transition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Verify the Proof On-Chain
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Claim Revocation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Claim Revocation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../getting-started/claim-revocation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Revoke Claim
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Services and protocols
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Services and protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/zklogin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Login protocol
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/querylanguage/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proof Query language
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/non-merklized/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Non-merklized credentials
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../w3c/merklization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JSON-LD merklization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rhs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reverse hash service
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Circuits
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Circuits
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/main-circuits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main Circuits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocol/template-circuits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Template Circuits
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../circom-snarkjs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Circom / snarkjs
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contracts/contracts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contracts
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../publications/publications/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Publications
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#assumptions" class="md-nav__link">
    <span class="md-ellipsis">
      Assumptions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#what-is-required" class="md-nav__link">
    <span class="md-ellipsis">
      What is Required?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#protocol-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Protocol Flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signature-protocol-v01-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Protocol v0.1: Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Signature Protocol v0.1: Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#auxiliary-data-structures" class="md-nav__link">
    <span class="md-ellipsis">
      Auxiliary Data Structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#identity-assertion-v01-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      Identity Assertion v0.1: Specifications
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Identity Assertion v0.1: Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      Algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature-verification-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Verification Algorithm
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#iden-assert-verification-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      Iden Assert Verification Algorithm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Iden Assert Verification Algorithm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#proof-of-claim-verification" class="md-nav__link">
    <span class="md-ellipsis">
      Proof of Claim Verification
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#iden3js-protocols" class="md-nav__link">
    <span class="md-ellipsis">
      iden3js Protocols
    </span>
  </a>
  
    <nav class="md-nav" aria-label="iden3js Protocols">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#login-identity-assertion" class="md-nav__link">
    <span class="md-ellipsis">
      Login (Identity Assertion)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Login (Identity Assertion)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#define-new-noncedb" class="md-nav__link">
    <span class="md-ellipsis">
      Define New NonceDB
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#generate-new-request-for-identity-assert" class="md-nav__link">
    <span class="md-ellipsis">
      Generate New Request for Identity Assert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sign-packet" class="md-nav__link">
    <span class="md-ellipsis">
      Sign Packet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verify-signed-packet" class="md-nav__link">
    <span class="md-ellipsis">
      Verify Signed Packet
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rationale" class="md-nav__link">
    <span class="md-ellipsis">
      Rationale
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Rationale">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature-format" class="md-nav__link">
    <span class="md-ellipsis">
      Signature Format
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Signature Format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#json-signing-formats" class="md-nav__link">
    <span class="md-ellipsis">
      JSON Signing Formats
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#possible-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Possible attacks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
    <nav class="md-nav" aria-label="References">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#webauth-api" class="md-nav__link">
    <span class="md-ellipsis">
      WebAuth API
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fido-security-guarantees-and-how-they-are-achieved" class="md-nav__link">
    <span class="md-ellipsis">
      FIDO Security Guarantees and How They are Achieved:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fido-threat-analysis-and-mitigations" class="md-nav__link">
    <span class="md-ellipsis">
      FIDO Threat Analysis and Mitigations:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#criticism" class="md-nav__link">
    <span class="md-ellipsis">
      Criticism:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-code-of-server-verification" class="md-nav__link">
    <span class="md-ellipsis">
      Example Code of Server Verification:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appendix" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Appendix">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-fido-protocols-security-goals" class="md-nav__link">
    <span class="md-ellipsis">
      The FIDO Protocols: Security Goals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="The FIDO Protocols: Security Goals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sg-1" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-1]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-2" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-2]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-3" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-3]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-4" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-4]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-5" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-5]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-6" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-6]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-7" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-7]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-8" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-8]
    </span>
  </a>
  
    <nav class="md-nav" aria-label="[SG-8]">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sg-9" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-9]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-10" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-10]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-11" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-11]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-12" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-12]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-13" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-13]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-14" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-14]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-15" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-15]
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sg-16" class="md-nav__link">
    <span class="md-ellipsis">
      [SG-16]
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="login-protocol">Login Protocol</h1>
<h2 id="introduction">Introduction</h2>
<p>The login protocol is based on the signature protocol, in which a user signs a packet using an authorized kSign key. For the login case, the user desires to assert a particular identity (an
Ethereum address in this case) to a server so that s/he is allowed access to the service while being identified.</p>
<p><img alt="Login Overview" src="../images/login_overview.png" /></p>
<h2 id="assumptions">Assumptions</h2>
<ul>
<li>Secure connection between wallet and server.</li>
<li>Secure connection between web client and server.</li>
<li>Wallet authenticates the server in the connection.</li>
<li>Web client authenticates the server in the connection.</li>
</ul>
<h2 id="what-is-required">What is Required?</h2>
<ul>
<li>Server authenticates the Ethereum address and Ethereum name from the wallet.</li>
<li>The user transfers the authentication from the wallet to the web client.</li>
</ul>
<h2 id="protocol-flow">Protocol Flow</h2>
<p><img alt="Login Flow" src="../images/login_flow.png" /></p>
<p>Challenges contain a cryptographic nonce and have a timeout that
indicates the validity of the nonce in the challenge. A signed challenge with a timed out nonce must be rejected by the server. The server must store a list of the nonces that have not timed out and have not been signed yet to guarantee the freshness.</p>
<p>A cryptographic nonce must be generated securely and must be long enough to avoid collisions (we use 256 bits).</p>
<h2 id="signature-protocol-v01-specifications">Signature Protocol v0.1: Specifications</h2>
<p>A signature may be requested as follows:</p>
<pre><code>{
  header: {
    typ: iden3.sig.v0_1
  }
  body: {
    type: TYPE
    data: DATA
  }
}
</code></pre>
<p>Depending upon the signature protocol specifications, a user generates a packet that may contain data from the signature request or can be created from scratch. The packet contains a header and a payload, is serialized, and signed following the <a href="https://tools.ietf.org/html/rfc7515">JWS standard</a>. Usually, the <code>form</code> is filled in by the user, and <code>data</code> is copied from a request.</p>
<p>The structures of the <code>data</code> and the <code>form</code> in the payload are specified by the <code>type</code> (what is being signed) in the payload. The rest of the elements are specified by the <code>typ</code> (signature packet) in the header.</p>
<pre><code>JWS_PAYLOAD = {
  type: TYPE
  data: DATA
  form: FORM
  ksign: str # ksing public key in compressed form
  proofKSing: proofClaim # Proof of authorize k sign claim (which contains the public key in compressed form)
}

JWS_HEADER = {
  typ: iden3.sig.v0_1
  iss: str # Ethereum Address
  iat: uint # issued at time, unix timestamp
  exp: uint # expiration time, unix timestamp
  alg: ? # algorithm
}

JWS_SIGN(JWS_HEADER, JWS_PAYLOAD)
</code></pre>
<p>Each signature request <code>type</code> has a view representation for the user, where the <code>data</code> and <code>form</code> are presented. Some of the values may be hidden from the user when necessary, but only if doing so doesn’t compromise the security of the user. In the request view, the user has the ability to pick some elements of the <code>form</code>.
<code>ksign</code> is the compressed public key of a secp256k ECDSA key pair. The <code>proofKSing</code> contains a KSign Authorize Claim for a secp256k public key.</p>
<p>As <code>JWS_HEADER.alg</code>, we will use a custom algorithm (not defined in the JWS standard): “EK256K1”, which is ECDSA with secp256k1 curve and keccak as a hash function, the same signature algorithm configuration as is used in Ethereum.</p>
<h3 id="auxiliary-data-structures">Auxiliary Data Structures</h3>
<pre><code>proofClaim: {
    signature: signature # Relay root + date signed by relay
    date: uint
    leaf: claim
    proofs: proofClaimPartial[]
}

proofClaimPartial: {
    mtp0: mtp # merkle tree proof of leaf existence
    mtp1: mtp # merkle tree proof of leaf non-existence
    root: key # merkle tree root
    aux: nil | { ver: uint, era: uint, idAddr: str } # Necessary data to construct SetRootClaim from root
}
</code></pre>
<p>Usually, the relay returns the <code>proofClaim</code> data structure to prove that a claim is valid and is in the Merkle tree.</p>
<h2 id="identity-assertion-v01-specifications">Identity Assertion v0.1: Specifications</h2>
<p>payload:</p>
<pre><code>type: iden3.iden_assert.v0_1
data: {
  challenge: nonce # 256 bits in base64
  timeout: uint # seconds
  origin: str # domain
}
form: {
  ethName: str # ethereumName
  proofAssignName: proofClaim # proof of claim Assign Name for ethName
}
</code></pre>
<p>A session id, if required, can be computed from the challenge. This session id can be used to link the communication between the web service and the wallet service.</p>
<p>view:</p>
<pre><code>type: Identity Assertion
data: {
  origin: str # domain
}
form: {
  ethName: str # ethereum name
}
</code></pre>
<h3 id="algorithms">Algorithms</h3>
<p>In the following sections, we will show an overview of the steps of the algorithms used for verification of the proofs and signatures used in the login protocol. The algorithms below consider the case in which there is a single trusted entity (identified by <code>relayPk</code>) that acts as a relay and as a domain name server.</p>
<h4 id="signature-verification-algorithm">Signature Verification Algorithm</h4>
<pre><code>VerifySignedPacket(jwsHeader, jwsPayload, signature, relayPk):
1. Verify jwsHeader.typ is 'iden3.sig.v0_1'
2. Verify jwsHeader.alg is 'EK256K1'
3. Verify that jwsHeader.iat &lt;= now() &lt; jwsHeader.exp 
4. Verify that jwsPayload.ksign is in jwsPayload.proofKSign.leaf
5. Verify that jwsHeader.iss is in jwsPayload.proofKSign
6. Verify that signature of JWS(jwsHeader, jwsPayload) by jwsPayload.ksign is signature
7. VerifyProofOfClaim(jwsPayload.proofKSign, relayPk)
</code></pre>
<p>In step 4 above, we verify that the ksign used to sign the packet is authorized by the user and is identified by the jwsHeader.iss Ethereum address.</p>
<h3 id="iden-assert-verification-algorithm">Iden Assert Verification Algorithm</h3>
<pre><code>VerifyIdenAssertV01(nonceDB, origin, jwsHeader, jwsPayload, signature, relayPk):
1. Verify jwsPayload.type is 'iden3.iden_assert.v0_1'
2. Verify jwsPayload.data.origin is origin
3. Verify jwsPayload.data.challenge is in nonceDB and hasn't expired, delete it
4. Verify that jwsHeader.iss and jwsPayload.form.ethName are in jwsPayload.proofAssignName.leaf
5. VerifyProofOfClaim(jwsPayload.form.ethName, relayPk)
</code></pre>
<h4 id="proof-of-claim-verification">Proof of Claim Verification</h4>
<pre><code>VerifyProofOfClaim(p, relayPk):
1. Verify signature of p.proofs[-1].root by relayPk is p.signature
   let leaf = p.leaf
2. loop for each proof in p.proofs:
    2.1 Verify proof.mtp0 is existence proof
    2.2 Verify proof.mtp0 with leaf and proof.root
    2.3 Verify proof.mtp1 is non-existence proof
    2.4 Verify proof.mtp1 with ClaimIncrementVersion(leaf) and proof.root
        leaf = NewClaimSetRootClaim(p.root, p.aux.ver, p.aux.era, p.aux.ethAddr)
</code></pre>
<!-- ### Rationale

See [this document](login_spec_rationale.md) for the rationale of some
decisions made in the design of this protocol. -->

<h2 id="iden3js-protocols">iden3js Protocols</h2>
<h3 id="login-identity-assertion">Login (Identity Assertion)</h3>
<pre><code>Wallet                                   Service
  +                                         +
  |           signatureRequest              |
  | &lt;-------------------------------------+ |
  |                                         |
  | +---+                                   |
  |     |                                   |
  |     |sign packet                        |
  |     |                                   |
  | &lt;---+                                   |
  |              signedPacket               |
  | +-------------------------------------&gt; |
  |                                         |
  |                                  +---+  |
  |                      verify      |      |
  |                      signedPacket|      |
  |                                  |      |
  |                                  +---&gt;  |
  |                                         |
  |                 ok                      |
  | &lt;-------------------------------------+ |
  |                                         |
  |                                         |
  |                                         |
  +                                         +
</code></pre>
<p>Read the login protocol specifications <a href="https://docs.iden3.io/protocol/zklogin/">here:</a></p>
<h4 id="define-new-noncedb">Define New NonceDB</h4>
<div class="js highlight"><pre><span></span><code>const nonceDB = new iden3.protocols.NonceDB();
</code></pre></div>
<h4 id="generate-new-request-for-identity-assert">Generate New Request for Identity Assert</h4>
<ul>
<li>Input<ul>
<li><code>nonceDB</code>: NonceDB class object</li>
<li><code>origin</code>: Domain of the emitter of the request</li>
<li><code>timeout</code>: Unix time format, valid until that date. For example, we can use 2 minutes (<code>2*60</code> seconds)</li>
</ul>
</li>
<li>
<p>Output</p>
<ul>
<li><code>signatureRequest</code>: <code>Object</code></li>
</ul>
<div class="js highlight"><pre><span></span><code>const signatureRequest = iden3.protocols.login.newRequestIdenAssert(nonceDB, origin, 2*60);
</code></pre></div>
</li>
</ul>
<p>The <code>nonce</code> of the <code>signatureRequest</code> can be accessed as:</p>
<div class="js highlight"><pre><span></span><code>const nonce = signatureRequest.body.data.challenge;
// nonce is the string containing the nonce value
</code></pre></div>
<p>We can add auxiliar data to the <code>nonce</code> in the <code>nonceDB</code> only one time:</p>
<div class="js highlight"><pre><span></span><code>const added = nodeDB.addAuxToNonce(nonce, auxdata);
// added is a bool confirming if the aux data had been added.
</code></pre></div>
<h4 id="sign-packet">Sign Packet</h4>
<ul>
<li>input<ul>
<li><code>signatureRequest</code>: object generated in the
    <code>newRequestIdenAssert</code> function</li>
<li><code>userAddr</code>: Ethereum address of the user who signs the data packet</li>
<li><code>ethName</code>: name assigned to the <code>userAddr</code></li>
<li><code>proofOfEthName</code>: <code>proofOfClaim</code> of the <code>ethName</code></li>
<li><code>kc</code>: iden3.KeyContainer object</li>
<li><code>ksign</code>: KOperational authorized for the <code>userAddr</code></li>
<li><code>proofOfKSign</code>: <code>proofOfClaim</code> of the <code>ksign</code></li>
<li><code>expirationTime</code>: Unix time format, signature will be valid until that date</li>
</ul>
</li>
<li>
<p>output</p>
<ul>
<li><code>signedPacket</code>: <code>String</code></li>
</ul>
<div class="js highlight"><pre><span></span><code>const expirationTime = unixtime + (3600 * 60);
const signedPacket = iden3.protocols.login.signIdenAssertV01(signatureRequest, usrAddr, ethName, proofOfEthName, kc, ksign, proofOfKSign, expirationTime);
</code></pre></div>
</li>
</ul>
<h4 id="verify-signed-packet">Verify Signed Packet</h4>
<ul>
<li>input<ul>
<li><code>nonceDB</code>: NonceDB class object</li>
<li><code>origin</code>: Domain of the emitter of the request</li>
<li><code>signedPacket</code>: Object generated in the <code>signIdenAssertV01</code> function</li>
</ul>
</li>
<li>
<p>output</p>
<ul>
<li><code>nonce</code>: Nonce object of the signedPacket that has been deleted from the nonceDB when the signedPacket is verified. If the verification fails, the nonce will be <code>undefined.</code></li>
</ul>
<div class="js highlight"><pre><span></span><code>const verified = iden3.protocols.login.verifySignedPacket(nonceDB, origin, signedPacket);
</code></pre></div>
</li>
</ul>
<!-- #### Appendix

See the [login specification document](login_spec.md) for information about the protocol design. -->

<h2 id="rationale">Rationale</h2>
<p>In the following sections, you will find references to a few protocols on which our login protocol relies or takes inspiration from.</p>
<h3 id="signature-format">Signature Format</h3>
<p>Use JSON to encode the object that will be signed.</p>
<h4 id="json-signing-formats">JSON Signing Formats</h4>
<p><a href="https://medium.facilelogin.com/json-message-signing-alternatives-897f90d411c">https://medium.facilelogin.com/json-message-signing-alternatives-897f90d411c</a></p>
<ul>
<li>JSON Web Signature (JWS)<ul>
<li>Doesn’t need canonicalization</li>
<li>Allows signing arbitrary data (not only JSON)</li>
<li>Widely used</li>
</ul>
</li>
<li>JSON Cleartext Signature (JCS)</li>
<li>Concise Binary Object Representation (CBOR) Object Signing</li>
</ul>
<p><a href="https://matrix.org/docs/spec/appendices.html#signing-json">https://matrix.org/docs/spec/appendices.html#signing-json</a></p>
<ul>
<li>Matrix JSON Signing<ul>
<li>Allows having multiple signatures with different protocols for a single JSON</li>
</ul>
</li>
</ul>
<h3 id="possible-attacks">Possible attacks</h3>
<p>See WebAuth API, FIDO Threat Analysis</p>
<h3 id="references">References</h3>
<ul>
<li><a href="https://en.wikipedia.org/wiki/OpenID">https://en.wikipedia.org/wiki/OpenID</a></li>
<li><a href="https://en.wikipedia.org/wiki/OpenID_Connect">https://en.wikipedia.org/wiki/OpenID_Connect</a></li>
<li><a href="https://en.wikipedia.org/wiki/IndieAuth">https://en.wikipedia.org/wiki/IndieAuth</a></li>
<li><a href="https://fidoalliance.org/how-fido-works/">https://fidoalliance.org/how-fido-works/</a></li>
</ul>
<h4 id="webauth-api">WebAuth API</h4>
<ul>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API">https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API</a></li>
<li><a href="https://w3c.github.io/webauthn/">https://w3c.github.io/webauthn/</a></li>
<li><a href="https://www.w3.org/TR/webauthn/">https://www.w3.org/TR/webauthn/</a></li>
<li><a href="https://www.webauthn.io/">https://www.webauthn.io/</a> (Demo)</li>
</ul>
<h4 id="fido-security-guarantees-and-how-they-are-achieved">FIDO Security Guarantees and How They are Achieved:</h4>
<ul>
<li><a href="https://fidoalliance.org/specs/fido-v2.0-id-20180227/fido-security-ref-v2.0-id-20180227.html#relation-between-measures-and-goals">https://fidoalliance.org/specs/fido-v2.0-id-20180227/fido-security-ref-v2.0-id-20180227.html#relation-between-measures-and-goals</a></li>
</ul>
<h4 id="fido-threat-analysis-and-mitigations">FIDO Threat Analysis and Mitigations:</h4>
<ul>
<li><a href="https://fidoalliance.org/specs/fido-v2.0-id-20180227/fido-security-ref-v2.0-id-20180227.html#threat-analysis">https://fidoalliance.org/specs/fido-v2.0-id-20180227/fido-security-ref-v2.0-id-20180227.html#threat-analysis</a> Currently (2018-01-08) there’s no support for iOS (Safari):</li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API#Browser_compatibility">https://developer.mozilla.org/en-US/docs/Web/API/Web_Authentication_API#Browser_compatibility</a></li>
</ul>
<h4 id="criticism">Criticism:</h4>
<ul>
<li><a href="https://www.scip.ch/en/?labs.20180424">https://www.scip.ch/en/?labs.20180424</a></li>
</ul>
<h4 id="example-code-of-server-verification">Example Code of Server Verification:</h4>
<ul>
<li><a href="https://github.com/duo-labs/webauthn/blob/fa6cd954884baf24fc5a51656ce21c1a1ef574bc/main.go#L336">https://github.com/duo-labs/webauthn/blob/fa6cd954884baf24fc5a51656ce21c1a1ef574bc/main.go#L336</a></li>
<li><a href="https://w3c.github.io/webauthn/#verifying-assertion">https://w3c.github.io/webauthn/#verifying-assertion</a></li>
</ul>
<h3 id="appendix">Appendix</h3>
<h4 id="the-fido-protocols-security-goals">The FIDO Protocols: Security Goals</h4>
<h5 id="sg-1">[SG-1]</h5>
<p><strong>Strong User Authentication</strong>: Authenticate (recognize) a user and/or a device to a relying party with high (cryptographic) strength. </p>
<h5 id="sg-2">[SG-2]</h5>
<p><strong>Credential Guessing Resilience</strong>: Provide robust protection against eavesdroppers, e.g. be resilient to physical observation, resilient to targeted impersonation, and resilient to throttled and unthrottled guessing.</p>
<h5 id="sg-3">[SG-3]</h5>
<p><strong>Credential Disclosure Resilience</strong>: Be resilient to phishing attacks and real-time phishing attacks including resilience to online attacks by adversaries that are able to actively manipulate network traffic. </p>
<h5 id="sg-4">[SG-4]</h5>
<p><strong>Unlinkablity</strong>: Protect the protocol conversation such that any two relying parties cannot link the conversation to one user (i.e. be unlinkable). </p>
<h4 id="sg-5">[SG-5]</h4>
<p><strong>Verifier Leak Resilience</strong>: Be resilient to leaks from other relying parties,i.e. nothing that the verifier could possibly leak can help an attacker impersonate the user to a relying party. </p>
<h4 id="sg-6">[SG-6]</h4>
<p><strong>Authenticator Leak Resilience</strong>: Be resilient to leaks from other FIDO Authenticators i.e., nothing that a particular FIDO Authenticator could possibly leak can help an attacker impersonate any other user to a relying party. </p>
<h4 id="sg-7">[SG-7]</h4>
<p><strong>User Consent</strong>: Notify the user before a relationship with a new relying party is being established (requiring explicit consent). </p>
<h4 id="sg-8">[SG-8]</h4>
<p><strong>Limited PII</strong>: Limit to the absolute minimum the amount of the Personal Identifiable Information (PII) that can get exposed to the relying party.</p>
<h5 id="sg-9">[SG-9]</h5>
<p><strong>Attestable Properties</strong>: The relying party must be able to verify FIDO Authenticator model/type (in order to calculate the associated risk). </p>
<h5 id="sg-10">[SG-10]</h5>
<p><strong>DoS Resistance</strong>: Be resilient to the Denial of Service attacks, i.e. prevent attackers from inserting invalid registration information for a legitimate user for the next login phase and therefore, the legitimate user will not be able to login successfully anymore. </p>
<h5 id="sg-11">[SG-11]</h5>
<p><strong>Forgery Resistance</strong>: Be resilient to the forgery attacks (impersonation attacks), i.e. prevent attackers from attempting to modify intercepted communications in order to masquerade as the legitimate user and be able to log in to the system. </p>
<h5 id="sg-12">[SG-12]</h5>
<p><strong>Parallel Session Resistance</strong>: Be resilient to the parallel session attacks. Without knowing a user’s authentication credential, an attacker can masquerade as a legitimate user. This can be done by creating a valid authentication message out of some eavesdropped communication between the user and the server. </p>
<h5 id="sg-13">[SG-13]</h5>
<p><strong>Forwarding Resistance</strong>: Be resilient to the forwarding and replay attacks. Having intercepted previous communications, an attacker can impersonate the legal user to authenticate to the system. This attacker can replay or forward the intercepted messages. </p>
<h5 id="sg-14">[SG-14]</h5>
<p><strong>Transaction Non-Repudiation</strong> <!--(not covered by U2F)-->: Provide strong cryptographic non-repudiation for secure transactions. </p>
<h5 id="sg-15">[SG-15]</h5>
<p><strong>Respect for Operating Environment Security Boundaries</strong>: Ensure that the registrations and the private keys, as a shared system resource, are appropriately protected according to the operating environment privilege boundaries on the FIDO user device. </p>
<h5 id="sg-16">[SG-16]</h5>
<p><strong>Assessable Level of Security</strong>: Ensure that the design and implementation of the authenticator allow the testing laboratory/FIDO Alliance to assess the level of security provided by the authenticator.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://t.me/iden3io" target="_blank" rel="noopener" title="t.me" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M248 8C111.033 8 0 119.033 0 256s111.033 248 248 248 248-111.033 248-248S384.967 8 248 8m114.952 168.66c-3.732 39.215-19.881 134.378-28.1 178.3-3.476 18.584-10.322 24.816-16.948 25.425-14.4 1.326-25.338-9.517-39.287-18.661-21.827-14.308-34.158-23.215-55.346-37.177-24.485-16.135-8.612-25 5.342-39.5 3.652-3.793 67.107-61.51 68.335-66.746.153-.655.3-3.1-1.154-4.384s-3.59-.849-5.135-.5q-3.283.746-104.608 69.142-14.845 10.194-26.894 9.934c-8.855-.191-25.888-5.006-38.551-9.123-15.531-5.048-27.875-7.717-26.8-16.291q.84-6.7 18.45-13.7 108.446-47.248 144.628-62.3c68.872-28.647 83.183-33.623 92.511-33.789 2.052-.034 6.639.474 9.61 2.885a10.45 10.45 0 0 1 3.53 6.716 43.8 43.8 0 0 1 .417 9.769"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/iden3/docs" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://iden3.io/" target="_blank" rel="noopener" title="iden3.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M0 3.75C0 2.784.784 2 1.75 2h20.5c.966 0 1.75.784 1.75 1.75v16.5A1.75 1.75 0 0 1 22.25 22H1.75A1.75 1.75 0 0 1 0 20.25ZM22.5 7h-21v13.25c0 .138.112.25.25.25h20.5a.25.25 0 0 0 .25-.25Zm-10-3.5v2h10V3.75a.25.25 0 0 0-.25-.25ZM7 3.5v2h4v-2Zm-5.25 0a.25.25 0 0 0-.25.25V5.5h4v-2Z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "content.code.copy"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>